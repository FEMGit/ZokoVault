<button class="primary-button big-button hidden" data-modal-id="wizard-modal" id="show-modal-button">
  Wizard Modal
</button>
<div id="wizard-modal" class="modal wizard-modal modal-no-js">
  <div class="step-wizard">
    <div class="inner-step" onclick="wizNav(1)">
      <span id="step-1" class="inner-counter">
        1
      </span>
      Details
    </div>
    <div class="inner-step" onclick="wizNav(2)">
      <span id="step-2" class="inner-counter">
        2
      </span>
      Category Info
    </div>
    <div class="inner-step" onclick="wizNav(3)">
      <span id="step-3" class="inner-counter">
        3
      </span>Avatar
    </div>
  </div>
  <div class="modal-header">
    <h2>Add Contact</h2>
  </div>
  <div class="modal-content">
    <%= form_for @contact, :html => {:id => "contact-form"} do |f| %>
      <% if @contact.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@contact.errors.count, "error") %> prohibited this contact from being saved:</h2>

          <ul>
          <% @contact.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
          </ul>
        </div>
      <% end %>

      <div id="detail-form">
        <div class="field">
          <%= f.label :firstname %><br>
          <%= f.text_field :firstname %>
        </div>
        <div class="field">
          <%= f.label :lastname %><br>
          <%= f.text_field :lastname %>
        </div>
        <div class="field">
          <%= f.label :emailaddress %><br>
          <%= f.text_field :emailaddress %>
        </div>
        <div class="field">
          <%= f.label :phone %><br>
          <%= f.text_field :phone %>
        </div>
        <div class="field">
          <%= f.label :category %><br>
          <%= f.text_field :category %>
        </div>
      </div>
      <div id="category-form">
        <div class="field">
          <%= f.label :relationship %><br>
          <%= f.text_field :relationship %>
        </div>
        <div class="field">
          <%= f.label :beneficiarytype %><br>
          <%= f.text_field :beneficiarytype %>
        </div>
        <div class="field">
          <%= f.label :ssn %><br>
          <%= f.text_field :ssn %>
        </div>
        <div class="field">
          <%= f.label :birthdate %><br>
          <%= f.date_select :birthdate %>
        </div>
        <div class="field">
          <%= f.label :address %><br>
          <%= f.text_field :address %>
        </div>
        <div class="field">
          <%= f.label :zipcode %><br>
          <%= f.text_field :zipcode %>
        </div>
        <div class="field">
          <%= f.label :state %><br>
          <%= f.text_field :state %>
        </div>

        <div class="field">
          <%= f.label :businessname %><br>
          <%= f.text_field :businessname %>
        </div>
        <div class="field">
          <%= f.label :businesswebaddress %><br>
          <%= f.text_field :businesswebaddress %>
        </div>
        <div class="field">
          <%= f.label :businessphone %><br>
          <%= f.text_field :businessphone %>
        </div>
        <div class="field">
          <%= f.label :businessfax %><br>
          <%= f.text_field :businessfax %>
        </div>


        <div class="field">
          <%= f.label :notes %><br>
          <%= f.text_area :notes %>
        </div>
      </div>
      <div id="avatar-form">
        <div class="field">
          <%= f.label :avatarcolor %><br>
          <%= f.text_field :avatarcolor %>
        </div>
        <div class="field">
          <%= f.label :photourl %><br>
          <%= f.text_field :photourl %>
        </div>


    <% end %>
  </div>
  <footer class="modal-footer">
    <button class="js-modal-close secondary-button big-button" onclick="submitContact(event)">Save</a>
    <button class="js-modal-close secondary-button big-button">Cancel</a>
  </footer>
</div>


<%#= link_to 'Back', contacts_path #%>
<script>
var wizNav = function(step){
  console.log("in " + step);
  if(step===1){
    console.log("in step 1");
    $("#detail-form").show();
    $("#avatar-form").hide();
    $("#category-form").hide();
    $("#step-1").removeClass().addClass("inner-counter current-step");
    $("#step-1").html('1');
    $("#step-2").removeClass().addClass("inner-counter");
    $("#step-2").html('2');
    $("#step-3").removeClass().addClass("inner-counter");
    $("#step-3").html('3');
  }
  else if(step===2){
    $("#detail-form").hide();
    $("#category-form").show();
    $("#avatar-form").hide();
    $("#step-1").removeClass().addClass("inner-counter completed-step");
    $("#step-1").html('<svg class="icon circle-icon"><use xlink:href="#icon-checkmark-1"> </use></svg>');
    $("#step-2").removeClass().addClass("inner-counter current-step");
    $("#step-2").html('2');
    $("#step-3").removeClass().addClass("inner-counter");
    $("#step-3").html('3');
  }
  else if(step===3){
    console.log("in 3");
    $("#detail-form").hide();
    $("#category-form").hide();
    $("#avatar-form").show();
    $("#step-1").removeClass().addClass("inner-counter completed-step");
    $("#step-1").html('<svg class="icon circle-icon"><use xlink:href="#icon-checkmark-1"> </use></svg>');
    $("#step-2").removeClass().addClass("inner-counter completed-step");
    $("#step-2").html('<svg class="icon circle-icon"><use xlink:href="#icon-checkmark-1"> </use></svg>');
    $("#step-3").removeClass().addClass("inner-counter current-step");
    $("#step-3").html('3');
  }
}
var submitContact = function(){
  var contactForm = document.getElementById("contact-form");
  contactForm.submit();
}
$(function(){

  //SOMEONE PLEASE FIX THIS GARBAGE
  var appendthis =  ("<div class='modal-overlay js-modal-close'></div>");
  $(document).ready(function(){
    $('button[data-modal-id]').click();
    wizNav(1);
  });
  $('button[data-modal-id]').click(function(e) {
    e.preventDefault();
    $("body").append(appendthis);
    $(".modal-overlay").fadeTo(500, 0.8);
    $(".js-modalbox").fadeIn(500);
    var modalBox = $(this).attr('data-modal-id');
    $('#'+modalBox).fadeIn($(this).data());
  });


  $(".js-modal-close, .modal-overlay").click(function() {
    $(".modal, .modal-overlay").fadeOut(500, function() {
      $(".modal-overlay").remove();
    });

  });

  //ESPECIALLY THIS GARBAGE
  $(window).resize(function() {
    $(".large-modal").css({
      top: ($(window).height() - $(".modal").outerHeight()) / 2,
      left: ($(window).width() - $(".large-modal").outerWidth()) / 2,
    });
  });
  $(window).resize(function() {
    $(".medium-modal").css({
      top: ($(window).height() - $(".modal").outerHeight()) / 2,
      left: ($(window).width() - $(".medium-modal").outerWidth()) / 2,
    });
  });
  $(window).resize(function() {
    $(".small-modal").css({
      top: ($(window).height() - $(".modal").outerHeight()) / 2,
      left: ($(window).width() - $(".small-modal").outerWidth()) / 2,
    });
  });
  $(window).resize();

});
</script>

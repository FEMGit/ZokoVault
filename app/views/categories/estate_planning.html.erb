<div>
  <a class="edit-link" href='#'>
    <span class="circle-button">
      <svg class="icon circle-icon">
        <use xlink:href="#icon-pencil-1"></use>
      </svg>
    </span>Edit
  </a>
  <h1>Wills - Trusts - Legal</h1>
</div>

<section class="flex-boxes">
  <div class="flex-column">
    <div class="card cg-1 column-card">
      <h3>Wills</h3>
      <% if @wills.any? %>
        <% @wills.each do |will| %>
          <div>
            <% will.primary_beneficiaries.each do |primary| %>
              <%= primary.name %> [primary]<br/>
            <% end %>

            <% will.secondary_beneficiaries.each do |secondary| %>
              <%= secondary.name %> [secondary]<br/>
            <% end %>
          </div>
        <% end %>
      <% else %>
        <span class="percent-complete">0% Complete</span>
      <% end %>
      <%= link_to 'Add Details', new_will_path, class: "add-details-link" %>
      <span class="clear"></span>
    </div>
    <% if @wills.any? %>
      <%= link_to details_will_path(1), :class => "undo-link-style" do %>
        <div class="card cg-1 column-card">
          <h3>Details For Will</h3>
          <span class="percent-complete">100% Complete</span>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="flex-column">
    <div class="card cg-2 column-card">
      <h3>Trusts</h3>
      <% if @trusts.any? %>
        <% @trusts.each do |trust| %>
          <div>
            <%= trust.name %>
          </div>
        <% end %>
      <% else %>
        <span class="percent-complete">0% Complete</span>
      <% end %>
      <%= link_to 'Add Details', new_trust_path, class: "add-details-link" %>
      <span class="clear"></span>
    </div>
    <% if @trusts.any? %>
      <%= link_to details_trust_path(1), :class => "undo-link-style" do %>
        <div class="card cg-2 column-card">
          <h3>Details For Trust</h3>
          <span class="percent-complete">100% Complete</span>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="flex-column">
    <div class="card cg-3 column-card">
      <h3>Powers of Attorney</h3>
      <% if @power_of_attorneys.any? %>
        <% @power_of_attorneys.each do |power_of_attorney| %>
          <div>
            <b><%= power_of_attorney.agents.map(&:name).join(", ") %></b><br>
            <%= power_of_attorney.powers.keys.join(",") %>
          </div>
        <% end %>
      <% else %>
        <span class="percent-complete">0% Complete</span>
      <% end %>
      <%= link_to 'Add Details', new_power_of_attorney_path, class: "add-details-link" %>
      <span class="clear"></span>
    </div>
    <% if @power_of_attorneys.any? %>
      <%= link_to details_attorney_path(1), :class => "undo-link-style" do %>
        <div class="card cg-3 column-card">
          <h3>Details For Legal</h3>
          <span class="percent-complete">100% Complete</span>
        </div>
      <% end %>
    <% end %>
  </div>

</section>


<div>
  <a class="add-link fr" href="<%= new_document_path(:category => @category, :return => "estate_planning") %>">
    <span class="circle-button">
      <svg class="icon circle-icon">
        <use xlink:href="#icon-plus-1"></use>
      </svg>
    </span>Add Document
  </a>
  <h1>Wills - Trusts - Legal Documents</h1>
</div>

<table>
  <tr>
    <th>Name</th>
    <th>Modified</th>
    <th>Tags</th>
    <th>Shared With</th>
    <th>Actions</th>
  </tr>
  <% @vault_entries.each do |vault_entry| %>
    <% next unless (document = vault_entry.document) %>
      <tr>
        <td>
          <a><%= link_to document.name, document_path(document) %></a>
        </td>
        <td><%= document.updated_at %></td>
        <td>tags</td>
        <td>
          <% vault_entry.share_with_contacts.each do |contact| %>
            <span class="user-circle"><%= contact.initials %></span>
          <% end %>
        </td>
        <td>
          <%= link_to 'Edit', edit_document_path(document), class: "outline-button small-button" %>
          <%= link_to 'Delete', document_path(document), method: :delete, data: {confirm: 'Are you sure?'}, class: "outline-button small-button" %>
        </td>
      </tr>
  <% end %>
  <% @wtl_documents.each do |wtl_doc| %>
    <tr>
      <td>
        <a><%= link_to wtl_doc.name, document_path(wtl_doc) %></a>
      </td>
      <td><%= wtl_doc.updated_at %></td>
      <td>tags</td>
      <td>
        <% wtl_doc.shares.each do |share| %>
          <span class="user-circle"><%= share.contact.initials %></span>
        <% end %>
      <td>
        <%= link_to 'Edit', edit_document_path(wtl_doc), class: "outline-button small-button" %>
        <%= link_to 'Delete', document_path(wtl_doc), method: :delete, data: {confirm: 'Are you sure?'}, class: "outline-button small-button" %>
      </td>
    </tr>
  <% end %>
</table>

<script>

$(function() {

  $('.flex-boxes').masonry({
    columnWidth: '.flex-column',
    gutter: 20,
    percentPosition: true,
    itemSelector: '.flex-column'
  });

});


</script>

<div>
  <a class="edit-link" href="#">
    <span class="circle-button">
      <svg class="icon circle-icon">
        <use xlink:href="#icon-pencil-1"></use>
      </svg>
    </span>Edit
  </a>
  <h1>Insurance</h1>
</div>

<section class="flex-boxes">
  <% new_link_paths = {
  "life" => new_life_path,
  "property" => new_property_path,
  "health" => new_health_path,
  } %>
  
  >
  <% @groups.each do |group| %>
    <div class="flex-column">

      <div class="card <%= group['value'] %> column-card">
        <h3><%= group["label"] %></h3>
        <%= link_to 'Add Details', new_link_paths[group['value']], class: "add-details-link" %>
        <span class="clear"></span>
      </div>

      <% if group['value']=="life" %>
        <% @insurance_vendors.select { |v| v["group"]=="life" }.each do |vendor| %>
          <%= link_to details_account_category_path(:category => @category, :group => 'life', :name => 'Met Life', :return => "insurance"), :class => "undo-link-style" do %>
              <div class="card <%= group['value'] %> column-card">
                <h3><%= vendor.name %></h3>
                <p><%= vendor.contact.firstname + " " + vendor.contact.lastname %></p>
                <p><%= vendor.webaddress %></p>
                <p><%= vendor.phone %></p>
              </div>
          <% end %>
        <% end %>
        <%= link_to details_account_category_path(:category => @category, :group => 'life', :name => 'Met Life', :return => "insurance"), :class => "undo-link-style" do %>
          <div class="card life column-card">
            <h3>Met Life</h3>
            <p>John Ponzleford</p>
            <p>j.ponzleford@allstate.com</p>
            <p>555-231-6754</p>
          </div>
        <% end %>

      <% end %>

      <% if group['value']=="property" %>
        <% @insurance_vendors.select { |v| v["group"]=="property" }.each do |vendor| %>
          <%= link_to details_account_category_path(:category => @category, :group => 'property', :name => 'All State', :return => "insurance"), :class => "undo-link-style" do %>
              <div class="card <%= group['value'] %> column-card">
                <h3><%= vendor.name %></h3>
                <p><%= vendor.contact.firstname + " " + vendor.contact.lastname %></p>
                <p><%= vendor.webaddress %></p>
                <p><%= vendor.phone %></p>
              </div>
          <% end %>
        <% end %>
        <%= link_to details_account_category_path(:category => @category, :group => 'property', :name => 'All State', :return => "insurance"), :class => "undo-link-style" do %>
          <div class="card property column-card">
            <h3>All State</h3>
            <p>John Ponzleford</p>
            <p>j.ponzleford@allstate.com</p>
            <p>555-231-6754</p>
          </div>
        <% end %>

      <% end %>

      <% if group['value']=="health" %>
      <% @insurance_vendors.select { |v| v["group"]=="health" }.each do |vendor| %>
          <%= link_to details_account_category_path(:category => @category, :group => 'health', :name => 'BCBSIL', :return => "insurance"), :class => "undo-link-style" do %>
              <div class="card <%= group['value'] %> column-card">
                <h3><%= vendor.name %></h3>
                <p><%= vendor.contact.firstname + " " + vendor.contact.lastname %></p>
                <p><%= vendor.webaddress %></p>
                <p><%= vendor.phone %></p>
              </div>
          <% end %>
        <% end %>
        <%= link_to details_account_category_path(:category => @category, :group => 'health', :name => 'BCBSIL', :return => "insurance"), :class => "undo-link-style" do %>
          <div class="card health column-card">
            <h3>BCBSIL</h3>
            <p>John Ponzleford</p>
            <p>j.ponzleford@allstate.com</p>
            <p>555-231-6754</p>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
</section>

<div>
  <a class="add-link fr" href="<%= new_document_path(:category => @category) %>">
    <span class="circle-button">
      <svg class="icon circle-icon">
        <use xlink:href="#icon-plus-1"></use>
      </svg>
    </span>Add Document
  </a>
  <h1>Insurance Documents</h1>
</div>

<table>
  <tr>
    <th>Name</th>
    <th>Modified</th>
    <th>Tags</th>
    <th>Shared With</th>
    <th>Actions</th>
  </tr>
  <% @insurance_documents.each do |document| %>
      <tr>
        <td>
          <a><%= link_to document.name, document_path(document) %></a>
        </td>
        <td><%= document.updated_at %></td>
        <td>tags</td>
        <td>
          <%= render :partial => "layouts/share_with_contacts", :locals => {:shares => document.shares} %>
        </td>
        <td>
          <%= link_to 'Edit', edit_document_path(document), class: "outline-button small-button" %>
          <%= link_to 'Delete', document_path(document), method: :delete, data: {confirm: 'Are you sure?'}, class: "outline-button small-button" %>
        </td>
      </tr>
  <% end %>
</table>

<script>

$(function() {

  $('.flex-boxes').masonry({
    columnWidth: '.flex-column',
    gutter: 20,
    percentPosition: true,
    itemSelector: '.flex-column'
  });

});


</script>

<% description ||= "" %>
<% description_bottom ||= "" %>
<% title ||= "" %>

<button class="primary-button big-button hidden unsaved-changes-modal" data-modal-id="wizard-modal"></button>
<div id="wizard-modal" class="modal wizard-modal modal-no-js confirmation-modal">
  <div class="confirmation-wrapper">
    <h2>Unsaved changes</h2>
    <p class="mb-0">These items will be permanently deleted and cannot be recovered. Are you sure?</p>
  </div>
  <footer class="modal-footer confirmation-footer">
    <%= link_to 'Save and Continue', '#', class: "button primary-button big-button save-and-continue" %>
    <%= link_to 'Skip and Continue', '#', class: "button primary-button big-button skip-and-continue margin-bottom-20" %>
  </footer>
</div>

<% wide ||= false %>
<% hidden_field_tag_values ||= nil %>

<div class="card mb-30 mt-20 max-w-1000-centered">
  <h1><%= title %></h1>
  <p class="mb-30"><%= description %></p>

  <%= form_for form_for_object, url: url_for(action: :create, controller: form_controller) do |f| %>
    <%= hidden_field_tag :next_page_number, @next_page %>
    <%= hidden_field_tag :page_number, @page_number %>

    <% if wide %>
      <div class="input-pair wide mobile-hide h-25">
        <% label_tag.each_with_index do |tag, index| %>
          <% label_class = 'input-form-class pl-0 b-color-transparent ' + (index > 0 ? 'ml-15' : '') %>
          <%= label_tag tag[:name], tag[:value], class: label_class %>
        <% end %>
        <%= label_tag "investment_name", '', class: 'inline-button' %>
      </div>
    <% else %>
      <%= label_tag label_tag[:name], label_tag[:value] %>
    <% end %>
    <%= render partial: 'tutorials/tutorial_resources', locals: { partial_path: partial_path,
                                                                  fields_class: fields_class,
                                                                  select_tag: wide && select_tag,
                                                                  text_field_tag: text_field_tag,
                                                                  label_tag: label_tag,
                                                                  wide: wide } %>

    <div class="collect-fields">
      <%= hidden_field_tag :tutorial_name, @tutorial_name %>
      <%= hidden_field_tag :next_tutorial, @next_tutorial.try(:name).try(:parameterize) || 'confirmation_page' %>

      <% hidden_field_tag_values.try(:each) do |hidden_field_tag_value| %>
        <%= hidden_field_tag hidden_field_tag_value[:name], hidden_field_tag_value[:value] %>
      <% end %>

      <div class="input-pair <% if wide %> wide <% end %> tutorial-fields add-tutorial <%= fields_class %>">
        <% if wide %>
          <%= label_tag label_tag[0][:name], label_tag[0][:value], class: 'mobile-show' %>
        <% end %>
        <%= text_field_tag text_field_tag[:name], "", class: "form-control medium repeated-field h-34", placeholder: text_field_tag[:placeholder], :maxlength => text_field_tag[:max_length] || get_max_length(:default) %>
        <% if wide %>
          <%= label_tag label_tag[1][:name], label_tag[1][:value], class: 'mobile-show' %>
          <% if select_tag[:multiple] == true %>
            <div class="chosen-styled-select form-control medium repeated-field ml-15">
              <%= collection_select 'tutorial_account_types', "[account_0][account_type]", select_tag[:value], :to_s, :to_s, {}, { class: "chosen-select", multiple: true } %>
            </div>
          <% else %>
            <div class="styled-select form-control medium repeated-field ml-15">
              <%= select_tag select_tag[:name], options_for_select(select_tag[:value], "") %>
            </div>
          <% end %>
        <% end %>
        <%= link_to 'Add Another', 'javascript:void(0);', class: "medium-button button primary-button inline-button add-another-btn"%>
      </div>
    </div>
    <span class="clear"></span>
    
    <% if description_bottom.present? %>
      <p class="mt-30 mb-0"><%= description_bottom %></p>
    <% end %>

    <%= render partial: 'tutorials/buttons_section', locals: { f: f } %>
  <% end %>
</div>

<script>
  $('.chosen-select').chosen({allow_single_deselect: true});
</script>